---
tags:
  - этап1
---
Тип структуры - значимый тип, который может объединять данные и связанный функционал. Чтобы объявить структуру используется ключевое слово `struct`:

```cs
public struct Coords
{
    public Coords(double x, double y)
    {
        X = x;
        Y = y;
    }

    public double X { get; }
    public double Y { get; }

    public override string ToString() => $"({X}, {Y})";
}
```

Тип структуры имеет семантику значимого типа. Так, переменная типа структуры содержит объект типа. По умолчанию значения переменных копируются при присвоении, передаче аргумента в метод и возвращении из метода.

Обычно структуры используются для создания маленьких типов, сфокусированных на данных с минимальным количеством логики или вообще без неё.

Так как структуры имеют семантику value-типа, рекомендуется создавать иммутабельные структуры.

```ad-important
Если структура содержит поле ссылочного типа, при копировании структуры сохранится ссылка на исходный объект ссылочного типа и обе копии структуры будут иметь доступ к одному объекту ссылочного типа.
```

# readonly структуры

Можно использовать модификатор `readonly`, чтобы сделать структуру иммутабельной.

В таком случае все члены readonly структуры автоматически становятся readonly, а автоматически имплементированные могут иметь метод `init` (доступно с C# 9+) но не могут иметь `set`.

Это гарантирует, что ни один член иммутабельной структуры не изменит её состояния.

```ad-note
В `readonly` структуре члены изменяемых ссылочных типов всё ещё могут менять своё состояние. Например, нельзя заменить объект `List<T>`, но можно добавить в него новый элемент.

```

```cs
public readonly struct Coords
{
    public Coords(double x, double y)
    {
        X = x;
        Y = y;
    }

    public double X { get; init; }
    public double Y { get; init; }

    public override string ToString() => $"({X}, {Y})";
}
```

# readonly члены объекта

Можно использовать модификатор `readonly` на отдельных членах, которые не изменяют состояние структуры, в случае, если нельзя применить модификатор `readonly` ко всей структуре.

Внутри `readonly`-члена нельзя присваивать значения полям структуры, но `readonly` член может вызывать не `readonly` члены. В этом случае компилятор создаёт копию структуры и вызывает не `readonly` член на этой копии, не изменяя оригинал.

Компилятор может использовать модификатор `readonly` для оптимизаций производительности, подробнее в [[Избегание аллокаций]].