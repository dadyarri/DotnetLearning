---
tags:
  - этап1
---
Финализаторы (ранее известные как деструкторы) используются для выполенения необходимой очистки, когда объект класса собирается сборщиком мусора. В большинстве случаев их не нужно использовать.

- Финализаторы не могут быть использованы в структурах, только в классах
- Класс может иметь только один финализатор
- Финализаторы не могут быть наследованы или перегружены
- Финализаторы не могут быть вызваны явно, это происходит автоматически
- Финализаторы не принимают модификаторов или аргументов

```cs
class Car
{
    ~Car()  // finalizer
    {
        // cleanup statements...
    }
}
```

Финализатор неявно вызывает `Finalize` базового класса объекта. Вызов финализатора неявно транслируется в такой код:

```cs
protected override void Finalize()
{
    try
    {
        // Cleanup statements...
    }
    finally
    {
        base.Finalize();
    }
}
```

Такой дизайн означает, что метод `Finalize` вызывается рекурсивно для всех объектов в цепочке наследования от самого конкретного к наименее конкретному.

```ad-note
Пустые финализаторы не должны использоваться. Наличие финализатора помещает объект в очередь финализации, которая обрабатывается сборщиком мусора. Когда он обрабатывает очередь, он вызывает финализатор каждого объекта. Ненужные финализаторы, например, пустые, вызывающие финализатор базового класса или только методы по какому-то условию вызывают ненеобходимую потерю в производительности.
```

Нет контроля над тем, когда финализатор вызывается, сборщик мусора сам принимает решение, когда это сделать. Он ищет объекты, которые больше не используются приложением. Если он считает объект пригодным для сборки, он вызывает финализатор (если существует) и освобождает занятую объектом память. Можно принудительно запустить сборку мусора, использовав `GC.Collect`, но в большинстве случаев это не рекомендуется, поскольку это может создать проблемы с производительностью.

Когда приложение завершается, .NET Framework пытается вызвать все оставшиеся финализаторы, в то время, как .NET 5 (Включая .NET Core) и более поздние версии не вызывают финализаторы во время завершения работы приложения.